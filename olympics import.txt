CREATE INDEX ON :Athlete(id);
CREATE INDEX ON :Athlete(name);
CREATE INDEX ON :Games(name);
CREATE INDEX ON :City(name);
CREATE INDEX ON :Country(noc);
CREATE INDEX ON :Country(name);
CREATE INDEX ON :Team(name);
CREATE INDEX ON :Event(name);

//Load Games and link to Cities
LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MERGE (a:Athlete {id:line.ID}) ON CREATE SET a.name = line.Name, a.sex = line.Sex;

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MERGE (g:Games {name:line.City + ' ' + line.Year}) ON CREATE SET g.year = line.Year, g.season = line.Season;

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MERGE (c:City {name:line.City});

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MERGE (cou:Country {noc:line.NOC});

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MERGE (t:Team {name:line.Team + ' ' + line.Event + ' ' + line.Year})
WITH t, line.Medal as medal WHERE line.Medal <> 'NA'
MERGE (m:Medal {type:medal})
CREATE (t)-[:WON]->(m);

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MERGE (e:Event {name:line.Event});

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MATCH (g:Games {name:line.City + ' ' + line.Year})
MATCH (c:City {name:line.City})
MERGE (g)-[:HELD_IN]->(c);

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MATCH (t:Team {name:line.Team + ' ' + line.Event + ' ' + line.Year})
MATCH (g:Games {name:line.City + ' ' + line.Year})
MERGE (t)-[:PARTICIPATED_IN]->(g);

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MATCH (t:Team {name:line.Team + ' ' + line.Event + ' ' + line.Year})
MATCH (e:Event {name:line.Event})
MERGE (t)-[:COMPETED_IN]->(e);

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MATCH (a:Athlete {id:line.ID})
MATCH (t:Team {name:line.Team + ' ' + line.Event + ' ' + line.Year})
MERGE (a)-[:PART_OF]->(t);

LOAD CSV WITH HEADERS FROM 'https://github.com/lju-lazarevic/bloom/blob/master/athlete_events.csv?raw=true' AS line
with line where line.Season="Winter"
MATCH (t:Team {name:line.Team + ' ' + line.Event + ' ' + line.Year})
MATCH (cou:Country {noc:line.NOC})
MERGE (t)-[:REPRESENTED]->(cou);

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/lju-lazarevic/bloom/master/noc_regions.csv?raw=true' AS line
MATCH (c:Country {noc:line.NOC})
SET c.name = line.region;




